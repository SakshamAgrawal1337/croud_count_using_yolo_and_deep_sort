<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Login</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/toast.css') }}" />
    <script src="{{ url_for('static', filename='js/toast.js') }}"></script>
</head>
<body>
    <div class="login-container">

        <!-- Left Side Image -->
        <div class="login-image">
            <img src="{{ url_for('static', filename='images/login-side.png') }}" alt="Login Image" />
        </div>

        <!-- Right Side Form -->
        <div class="login-form">
            <h2>Login</h2>

            <form method="POST" id="loginForm" autocomplete="on" action="{{ url_for('auth.login') }}">
                <!-- Flask doesn't have built-in CSRF by default, use Flask-WTF for that -->
                <label for="username">Username</label>
                <input type="text" name="username" id="username" class="form-control" required placeholder="Enter your username" autocomplete="username" />

                <label for="password">Password</label>
                <input type="password" name="password" id="password" class="form-control" required placeholder="Enter your password" autocomplete="current-password" />

                <button type="submit">Login</button>
            </form>
            <p style="margin-top: 0px;">Don't have an account? <a href="{{ url_for('auth.register') }}">Register here</a></p>
            <p style="margin-top: 0px;">For Admin Login, <a href="{{ url_for('auth.admin_login') }}">Click me!</a></p>
        </div>
    </div>

    {% for category, message in get_flashed_messages(with_categories=true) %}
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        showToast('{{ category }}', '{{ message | safe }}');
    });
    </script>
    {% endfor %}

    <script>
        const form = document.getElementById('loginForm');
        form.addEventListener('submit', (e) => {
            const username = form.username.value.trim();
            const password = form.password.value.trim();

            if (!username || !password) {
                e.preventDefault(); // Stop submission if fields are empty
                // Use toast error instead of alert
                if (window.toast) {
                    window.toast.error('Please fill all the fields');
                } else {
                    alert('Please fill all the fields');
                }
            }
        });
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- <script src="{{ url_for('static', filename='js/toast.js') }}"></script> -->
</body>
</html>
