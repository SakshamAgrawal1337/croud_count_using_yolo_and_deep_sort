<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Analysis Preview</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">

  <!-- Chart.js for visualizations -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/heatmap.js"></script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  <!-- Header -->
  <header>
    <nav class="navbar navbar-dark bg-dark px-4 shadow-sm">
      <div class="d-flex align-items-center">
        <img src="https://cdn-icons-png.flaticon.com/512/847/847969.png" alt="logo" width="32" height="32" class="me-2">
        <span class="navbar-brand mb-0 h1">Crowd Count Dashboard</span>
          <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
          <li><a href="{{ url_for('auth.profile') }}" class="nav-link px-2 text-secondary">Dashboard</a></li>
          <li><a href="{{ url_for('dashboard.dashboard') }}" class="nav-link px-2 text-white">Zone Management</a></li>
          <li><a href="#" class="nav-link px-2 text-white">Analytics</a></li>
          <li><a href="#" class="nav-link px-2 text-white">About</a></li>
        </ul>
      </div>
      <div class="text-end">
      <span class="text-light me-2 ">Hi, {{ session.username }}</span>
      <button id="signOutBtn" class="btn btn-outline-light btn-sm ">Sign Out</button>
      </div>
    </nav>
  </header>

  <!-- Main Container -->
  <div id="container">
    <div class="content">
      <main>
        <h2>Analysis Preview</h2>
        <div class="card p-3 shadow-sm rounded-4">
          <div id="analysisVideoContainer" class="position-relative">
            <img id="analysisVideo" class="w-100 rounded-3" style="max-height: 360px;">
            <canvas id="analysisCanvas" width="640" height="360" class="position-absolute top-0 start-0 w-100 h-100"></canvas>
          </div>
          <div class="mt-3">
            <button id="startAnalysisBtn" class="btn btn-primary btn-sm">Start Analysis</button>
            <button id="stopAnalysisBtn" class="btn btn-danger btn-sm" style="display:none;">Stop Analysis</button>
            <button id="toggleHeatmapBtn" class="btn btn-secondary btn-sm ms-2" style="display:none;">Toggle Heatmap</button>
            <button id="toggleDeepsortBtn" class="btn btn-info btn-sm ms-2" style="display:none;">Enable DeepSort</button>
          </div>
          <div id="crowdCounts" class="mt-4">
            <p id="videoCount" class="mb-1">Video Count: 0</p>
            <div id="zoneCounts"></div>
          </div>
          <div id="alertContainer" class="mt-4" style="display:none;">
            <div class="alert alert-danger" role="alert">
              <h5>⚠️ ALERT: Zone Population Exceeded!</h5>
              <div id="alertMessage"></div>
            </div>
          </div>
          <div class="mt-4">
            <h5>Zone Population Chart</h5>
            <canvas id="zoneChart" width="300" height="200"></canvas>
          </div>
          <div class="mt-4">
            <h5>Population Trend</h5>
            <canvas id="trendChart" width="300" height="200"></canvas>
          </div>
          <div class="mt-4">
            <h5>Heatmap</h5>
            <canvas id="heatmapChartCanvas" width="300" height="200"></canvas>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <p>© Crowd Counting Dashboard</p>
  </footer>

  <!-- Your Custom JS -->
  <script src="{{ url_for('static', filename='js/visualizations.js') }}"></script>
  <script src="{{ url_for('static', filename='js/yolo_analysis.js') }}"></script>
  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
